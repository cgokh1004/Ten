<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ktx">

	<delete id="delete" parameterType="int">
		DELETE FROM ktx
		WHERE ktx_no=#{ktx_no}
	</delete>
		
	<update id="update" parameterType="ktxDTO">
		UPDATE ktx
		SET r_point = #{r_point}, s_point =#{s_point},s_date=#{s_date},purpose=#{purpose},content=#{content},price=#{price},seat=#{seat}
		WHERE ktx_no = #{ktx_no}
	</update>
	
	<insert id="create" parameterType="ktxDTO">
		INSERT INTO ktx(ktx_no, s_point, r_point, purpose,s_date, seat,price, content, reg_date,ID )  
		VALUES((SELECT NVL(MAX(ktx_no), 0) + 1 as ktx_no FROM ktx),#{s_point},#{r_point},#{purpose},#{s_date},
		#{seat},#{price},#{content},sysdate,#{ID})   

	</insert>


	<select id="list" resultType="ktxDTO" parameterType="Map">
	
		SELECT ktx_no, s_point, r_point, purpose,s_date, seat,price, content, reg_date,ID, r
		FROM(
			SELECT ktx_no, s_point, r_point, purpose,s_date, seat,price, content, reg_date,ID, rownum r
			  FROM(
				SELECT ktx_no, s_point, r_point, purpose,s_date, seat,price, content, reg_date,ID
				FROM ktx  
			ORDER BY ktx_no DESC
			)
			)                                                                            
	   <![CDATA[                                                                        
	   where r>=#{sno} and r<=#{eno}  
	   ]]>
		</select>                                          
						

	<select id="read" resultType="ktxDTO" parameterType="int">
		SELECT ktx_no, s_point, r_point, purpose,s_date, seat,price, content, reg_date,ID
		FROM ktx
		WHERE ktx_no = #{ktx_no}
	</select>

	<select id="total" parameterType="map" resultType="int">
		select count(*)
		from ktx
	</select>

</mapper>
 
